{"ast":null,"code":"import _asyncToGenerator from \"/Users/laurenzhinterholzer/Documents/Statistik/Statistik 2022S/BAC Statistik/platform/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component, EventEmitter, Input, Output } from \"@angular/core\";\nlet FileUploadComponent = class FileUploadComponent {\n  constructor(fileUploadService, fb) {\n    this.fileUploadService = fileUploadService;\n    this.fb = fb;\n    this.fileRemoved = new EventEmitter();\n    this.fileAdded = new EventEmitter();\n    this.fileModified = new EventEmitter();\n    this.fileUploadGroup = this.fb.group({\n      fileUpload: [null, []]\n    }); // problem with interface\n\n    this.isSaving = false; // disabled is not working\n\n    this.disabled = false;\n    this._fileId = -1;\n    this._originalId = -1;\n    this._fileRemoved = false;\n    this._fileSelected = false;\n  }\n\n  set fileId(value) {\n    var _this = this;\n\n    this._fileId = value;\n\n    if (value > -1) {\n      this._originalId = value;\n\n      _asyncToGenerator(function* () {\n        _this.fileMetaData = yield _this.fileUploadService.getFileMetaData(value).toPromise();\n      })();\n    } else {\n      this.fileMetaData = undefined;\n    }\n  }\n\n  get fileId() {\n    return this._fileId;\n  }\n  /**\n   * Returns whether the file is set or not.\n   */\n\n\n  isFileSet() {\n    return this._fileId > -1;\n  }\n  /**\n   * Event handler for a file change.\n   */\n\n\n  fileChanged() {\n    this._fileSelected = true;\n  }\n  /**\n   * Downloads the current file.\n   */\n\n\n  downloadCurrentFile() {\n    this.fileUploadService.retrieveAndDownloadFile(this.fileId);\n  }\n  /**\n   * Marks the current file as removed.\n   */\n\n\n  removeCurrentFile() {\n    this.fileId = -1;\n    this._fileRemoved = true;\n  }\n  /**\n   * Asynchronously saves the current file selection.\n   */\n\n\n  saveAsync() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      let newId = -1;\n      _this2.isSaving = true;\n\n      if (_this2._fileRemoved) {\n        yield _this2.fileUploadService.deleteFile(_this2._originalId).toPromise();\n      }\n\n      if (_this2._fileSelected) {\n        const fileList = _this2.fileUploadGroup.get(['fileUpload']).value;\n\n        const file = fileList.item(0);\n        newId = yield _this2.fileUploadService.uploadFile(file).toPromise();\n      }\n\n      if (_this2._fileRemoved && newId === -1) {\n        _this2.fileRemoved.emit(_this2._originalId);\n      } else if (!_this2._fileRemoved && _this2._originalId < 0 && newId >= 0) {\n        _this2.fileAdded.emit(newId);\n      } else if ((_this2._fileRemoved || _this2._originalId >= 0 && _this2._originalId !== newId) && newId >= 0) {\n        yield _this2.fileUploadService.deleteFile(_this2._originalId).toPromise();\n\n        _this2.fileModified.emit([_this2._originalId, newId]);\n      }\n\n      _this2.fileId = newId;\n      _this2.isSaving = false;\n    })();\n  }\n\n};\n\n__decorate([Output()], FileUploadComponent.prototype, \"fileRemoved\", void 0);\n\n__decorate([Output()], FileUploadComponent.prototype, \"fileAdded\", void 0);\n\n__decorate([Output()], FileUploadComponent.prototype, \"fileModified\", void 0);\n\n__decorate([Input()], FileUploadComponent.prototype, \"disabled\", void 0);\n\n__decorate([Input()], FileUploadComponent.prototype, \"fileId\", null);\n\nFileUploadComponent = __decorate([Component({\n  selector: 'jhi-file-upload',\n  templateUrl: './file-upload.component.html',\n  styleUrls: ['./file-upload.component.scss']\n})], FileUploadComponent);\nexport { FileUploadComponent };","map":{"version":3,"sources":["/Users/laurenzhinterholzer/Documents/Statistik/Statistik 2022S/BAC Statistik/platform/src/main/webapp/app/shared/file/file-upload/file-upload.component.ts"],"names":["__decorate","Component","EventEmitter","Input","Output","FileUploadComponent","constructor","fileUploadService","fb","fileRemoved","fileAdded","fileModified","fileUploadGroup","group","fileUpload","isSaving","disabled","_fileId","_originalId","_fileRemoved","_fileSelected","fileId","value","fileMetaData","getFileMetaData","toPromise","undefined","isFileSet","fileChanged","downloadCurrentFile","retrieveAndDownloadFile","removeCurrentFile","saveAsync","newId","deleteFile","fileList","get","file","item","uploadFile","emit","prototype","selector","templateUrl","styleUrls"],"mappings":"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","sourcesContent":["import { __decorate } from \"tslib\";\nimport { Component, EventEmitter, Input, Output } from \"@angular/core\";\nlet FileUploadComponent = class FileUploadComponent {\n    constructor(fileUploadService, fb) {\n        this.fileUploadService = fileUploadService;\n        this.fb = fb;\n        this.fileRemoved = new EventEmitter();\n        this.fileAdded = new EventEmitter();\n        this.fileModified = new EventEmitter();\n        this.fileUploadGroup = this.fb.group({\n            fileUpload: [null, []],\n        });\n        // problem with interface\n        this.isSaving = false;\n        // disabled is not working\n        this.disabled = false;\n        this._fileId = -1;\n        this._originalId = -1;\n        this._fileRemoved = false;\n        this._fileSelected = false;\n    }\n    set fileId(value) {\n        this._fileId = value;\n        if (value > -1) {\n            this._originalId = value;\n            (async () => {\n                this.fileMetaData = await this.fileUploadService.getFileMetaData(value).toPromise();\n            })();\n        }\n        else {\n            this.fileMetaData = undefined;\n        }\n    }\n    get fileId() {\n        return this._fileId;\n    }\n    /**\n     * Returns whether the file is set or not.\n     */\n    isFileSet() {\n        return this._fileId > -1;\n    }\n    /**\n     * Event handler for a file change.\n     */\n    fileChanged() {\n        this._fileSelected = true;\n    }\n    /**\n     * Downloads the current file.\n     */\n    downloadCurrentFile() {\n        this.fileUploadService.retrieveAndDownloadFile(this.fileId);\n    }\n    /**\n     * Marks the current file as removed.\n     */\n    removeCurrentFile() {\n        this.fileId = -1;\n        this._fileRemoved = true;\n    }\n    /**\n     * Asynchronously saves the current file selection.\n     */\n    async saveAsync() {\n        let newId = -1;\n        this.isSaving = true;\n        if (this._fileRemoved) {\n            await this.fileUploadService.deleteFile(this._originalId).toPromise();\n        }\n        if (this._fileSelected) {\n            const fileList = this.fileUploadGroup.get(['fileUpload']).value;\n            const file = fileList.item(0);\n            newId = await this.fileUploadService.uploadFile(file).toPromise();\n        }\n        if (this._fileRemoved && newId === -1) {\n            this.fileRemoved.emit(this._originalId);\n        }\n        else if (!this._fileRemoved && this._originalId < 0 && newId >= 0) {\n            this.fileAdded.emit(newId);\n        }\n        else if ((this._fileRemoved || (this._originalId >= 0 && this._originalId !== newId)) && newId >= 0) {\n            await this.fileUploadService.deleteFile(this._originalId).toPromise();\n            this.fileModified.emit([this._originalId, newId]);\n        }\n        this.fileId = newId;\n        this.isSaving = false;\n    }\n};\n__decorate([\n    Output()\n], FileUploadComponent.prototype, \"fileRemoved\", void 0);\n__decorate([\n    Output()\n], FileUploadComponent.prototype, \"fileAdded\", void 0);\n__decorate([\n    Output()\n], FileUploadComponent.prototype, \"fileModified\", void 0);\n__decorate([\n    Input()\n], FileUploadComponent.prototype, \"disabled\", void 0);\n__decorate([\n    Input()\n], FileUploadComponent.prototype, \"fileId\", null);\nFileUploadComponent = __decorate([\n    Component({\n        selector: 'jhi-file-upload',\n        templateUrl: './file-upload.component.html',\n        styleUrls: ['./file-upload.component.scss'],\n    })\n], FileUploadComponent);\nexport { FileUploadComponent };\n"]},"metadata":{},"sourceType":"module"}